# API Yamdb

## Описание
Проект YaMDb собирает отзывы пользователей на произведения. Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.
Произведения делятся на категории, такие как «Книги», «Фильмы», «Музыка». Например, в категории «Книги» могут быть произведения «Винни-Пух и все-все-все» и «Марсианские хроники», а в категории «Музыка» — песня «Давеча» группы «Жуки» и вторая сюита Баха. Список категорий может быть расширен (например, можно добавить категорию «Изобразительное искусство» или «Ювелирка»). 
Произведению может быть присвоен жанр из списка предустановленных (например, «Сказка», «Рок» или «Артхаус»). 
Добавлять произведения, категории и жанры может только администратор.
Благодарные или возмущённые пользователи оставляют к произведениям текстовые отзывы и ставят произведению оценку в диапазоне от одного до десяти (целое число); из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). На одно произведение пользователь может оставить только один отзыв.
Пользователи могут оставлять комментарии к отзывам.
Добавлять отзывы, комментарии и ставить оценки могут только аутентифицированные пользователи.

**Ключевые особенности:**

*   **Верификация** Верификация по email
*   **Категории и жанры:** Произведения классифицируются по категориям и жанрам, что облегчает навигацию и поиск.
*   **Отзывы и оценки:** Пользователи могут делиться своими мнениями и оценивать произведения.
*   **Рейтинг:** Автоматический расчет среднего рейтинга произведений.
*   **Комментарии:** Возможность комментировать отзывы других пользователей.
*   **Роли:** Разграничение доступа для администраторов и обычных пользователей.
*   **Аутентификация:** Доступ к оставлению отзывов и комментариев доступен только для аутентифицированных пользователей.

## Эндпоинты API

### Аутентификация

*   `POST /api/v1/auth/signup/`
    *   **Описание:** Регистрация нового пользователя.
    *   **Параметры тела запроса (JSON):** `username`, `email`.
    *   **Ответ:**
        *   `201 Created`: Пользователь успешно зарегистрирован. В теле ответа будет `confirmation_code` для подтверждения почты.
        *   `400 Bad Request`: Ошибка при валидации данных.
*   `POST /api/v1/auth/token/`
    *   **Описание:** Получение JWT-токена.
    *   **Параметры тела запроса (JSON):** `username`, `confirmation_code`.
    *   **Ответ:**
        *   `200 OK`: Успешная аутентификация, возвращается JWT-токен.
        *   `401 Unauthorized`: Неверные учетные данные.

### Пользователи

*   `GET /api/v1/users/`
    *   **Описание:** Получить список всех пользователей (доступ Администратора).
    *   **Ответ:** `200 OK`, массив JSON с данными пользователей.
*   `POST /api/v1/users/`
   *  **Описание:** Создать нового пользователя (доступ Администратора).
   *  **Параметры тела запроса (JSON):**  `username`(обязательное поле), `email`(обязательное поле), `first_name`, `last_name`, `bio`, `role`.
   *  **Ответ:** `201 Created`, данные нового пользователя.
*   `GET /api/v1/users/{username}/`
    *   **Описание:** Получить данные пользователя по имени (доступ Администратора).
    *   **Ответ:** `200 OK`, данные пользователя в JSON.
*  `PATCH /api/v1/users/{username}/`
      * **Описание:** Обновить данные пользователя (доступ Администратора).
      * **Параметры тела запроса (JSON):** `username`, `email`, `first_name`, `last_name`, `role`.
        Параметры `username` и `email` не являются обязательным, но не могут быть пустыми.
      * **Ответ:** `200 OK`, обновленные данные пользователя.
*  `DELETE /api/v1/users/{username}/`
      *   **Описание:** Удалить пользователя (доступ Администратора).
      *  **Ответ:** `204 No Content`
*   `GET /api/v1/users/me/`
     * **Описание:** Получить данные пользователя выполняющего запрос (доступ Авторизованный пользователь).
    *   **Ответ:** `200 OK`, данные текущего пользователя в JSON.
*   `PATCH /api/v1/users/me/`
     *  **Описание:** Обновить данные текущего пользователя (доступ Авторизованный пользователь).
      * **Параметры тела запроса (JSON):** `username`, `email`, `first_name`, `last_name`, `role`.
     * **Ответ:** `200 OK`, обновленные данные пользователя.

### Категории

*   `GET /api/v1/categories/`
    *   **Описание:** Получить список всех категорий (доступен Всем).
    *   **Ответ:** `200 OK`, Ответ JSON со списком всех категорий.
*   `POST /api/v1/categories/`
    *   **Описание:** Создать новую категорию (доступ Администратора).
    *   **Параметры тела запроса (JSON):** `name`, `slug`.
        Поле `slug` должно быть уникальным.
    *   **Ответ:** `201 Created`, данные новой категории.
*   `DELETE /api/v1/categories/{slug}/`
      *   **Описание:** Удалить категорию (доступ Администратора).
      *  **Ответ:** `204 No Content`

### Жанры

*   `GET /api/v1/genres/`
    *   **Описание:** Получить список всех жанров (доступен Всем).
    *   **Ответ:** `200 OK`, Ответ JSON со списком всех жанров.
*   `POST /api/v1/genres/`
    *   **Описание:** Создать новый жанр (доступ Администратора).
    *   **Параметры тела запроса (JSON):** `name`, `slug`.
        Поле `slug` должно быть уникальным.
    *   **Ответ:** `201 Created`, данные нового жанра.
*   `DELETE /api/v1/genres/{slug}/`
      *   **Описание:** Удалить жанр (доступ Администратора).
      *  **Ответ:** `204 No Content`

### Произведения

*  `GET /api/v1/titles/`
    *  **Описание:** Получить список всех произведений (доступен Всем).
    *   **Ответ:** `200 OK`, Ответ JSON со списком всех произведений.
*  `POST /api/v1/titles/`
    *  **Описание:** Создать новое произведение (доступ Администратора).
    *   **Параметры тела запроса (JSON):** `name`, `year`, `description`, `genre` (список `slug`). `category` (slug).
        Все поля, кроме `description` являются обязательными.
    *   **Ответ:** `201 Created`, данные нового произведения.
*  `GET /api/v1/titles/{title_id}/`
    *  **Описание:** Получить данные произведения по `id` (доступен Всем).
    *  **Ответ:** `200 OK`, данные произведения в JSON.
*  `PATCH /api/v1/titles/{title_id}/`
     *  **Описание:** Обновить данные произведения (доступ Администратора).
     *  **Параметры тела запроса (JSON):** `titles_id`, `name`, `year` `description`, `genre` (список `slug`), category (`slug`).
        Все поля, кроме `description` являются обязательными.
     * **Ответ:** `200 OK`, обновленные данные произведения.
*  `DELETE /api/v1/titles/{title_id}/`
       *  **Описание:** Удалить произведение (доступ Администратора).
       *  **Ответ:** `204 No Content`

### Отзывы (Reviews)

*   `GET /api/v1/titles/{title_id}/reviews/`
    *   **Описание:** Получить список отзывов к произведению (доступен Всем).
    *   **Ответ:** `200 OK`, Ответ JSON со списком всех отзывов.
*   `POST /api/v1/titles/{title_id}/reviews/`
    *   **Описание:** Создать новый отзыв к произведению (доступ Авторизованный пользователь).
    *   **Параметры тела запроса (JSON):** `text`, `score` (от 1 до 10).
        Пользователь может оставить только один отзыв на произведение. Все поля обязательные.
    *   **Ответ:** `201 Created`, данные нового отзыва.
*   `GET /api/v1/titles/{title_id}/reviews/{review_id}/`
    *   **Описание:** Получить данные отзыва по `id` (доступен Всем).
    *   **Ответ:** `200 OK`, данные отзыва в JSON.
*  `PATCH /api/v1/titles/{title_id}/reviews/{review_id}/`
    *   **Описание:** Обновить данные отзыва (доступ Автора, Модератора или Администратора)
    *   **Параметры тела запроса (JSON):** `text`, `score` (от 1 до 10).
        Все поля обязательные.
    *   **Ответ:** `200 OK`, обновленные данные отзыва.
*   `DELETE /api/v1/titles/{title_id}/reviews/{review_id}/`
     *   **Описание:** Удалить отзыв (доступ Автора, Модератора или Администратора)
    *   **Ответ:** `204 No Content`

### Комментарии (Comments)

*   `GET /api/v1/titles/{title_id}/reviews/{review_id}/comments/`
    *   **Описание:** Получить список комментариев к отзыву (доступен Всем).
    *   **Ответ:** `200 OK`, Ответ JSON со списком всех комментариев.
*   `POST /api/v1/titles/{title_id}/reviews/{review_id}/comments/`
    *   **Описание:** Создать новый комментарий к отзыву (доступ Авторизованный пользователь).
    *   **Параметры тела запроса (JSON):** `text`.
    Поле `text` является обязательным.
    *   **Ответ:** `201 Created`, данные нового комментария, с датой публикации.
*   `GET /api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/`
    *   **Описание:** Получить данные комментария по `id` (доступен Всем).
    *   **Ответ:** `200 OK`, данные комментария в JSON.
*   `PATCH /api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/`
    *  **Описание:** Обновить данные комментария (доступ Автора, Модератора или Администратора)
    *  **Параметры тела запроса (JSON):** `text`.
       Поле `text` является обязательным.
    *  **Ответ:** `200 OK`, обновленные данные комментария.
*   `DELETE /api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/`
    *   **Описание:** Удалить комментарий (доступ Автора, Модератора или Администратора)
    *   **Ответ:** `204 No Content`

## Технологии

*   Python 3.9
*   Django 3.2
*   Django REST Framework 3.12.4
*   Django restframework simpleJWT 5.2.2
*   Django-filter 2.4

## Как запустить проект

1.  Клонируйте репозиторий:
    ```bash
    git clone https://github.com/Beaver-IK/api_yamdb.git
    cd api_yamdb
    ```
2.  Создайте виртуальное окружение (рекомендуется):
    ```bash
    python -m venv venv
    source venv/bin/activate   # для Linux/macOS
    venv\Scripts\activate      # для Windows
    ```
3.  Установите зависимости:
    ```bash
    pip install -r requirements.txt
    ```
4.  Выполните миграции:
    ```bash
    python manage.py migrate
    ```
5.  Создайте суперпользователя:
    ```bash
    python manage.py createsuperuser
    ```
6.  Запустите сервер:
    ```bash
    python manage.py runserver
    ```

## Аутентификация

*   Для регистрации новых пользователей используется эндпоинт `/auth/signup/`.
    * При успешной регистрации в ответе будет `confirmation_code`
*   Для аутентификации и получения JWT-токена используется эндпоинт `/auth/token/`.
    * Для получения токена необходимо передать `confirmation_code`
*   Администраторы имеют полный доступ к API, используя JWT-токен, полученный при аутентификации.

## В разработке учавствовали

